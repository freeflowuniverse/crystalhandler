<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>tfgrid | vdoc</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  
		<link rel="stylesheet" href="doc.css" />
		<link rel="stylesheet" href="normalize.css" />
		<script src="dark-mode.js"></script>
</head>

<body>
  <div><a id="skip-to-content-link" href="#main-content">Skip to content</a></div>
  <div id="page">
    <header class="doc-nav hidden">
      <div class="heading-container">
        <div class="heading">
          <div class="info">
            <div class="module">twinactions</div>
            <div class="toggle-version-container">
              <span> b8438de</span>
              <div id="dark-mode-toggle" role="switch" aria-checked="false" aria-label="Toggle dark mode"><svg xmlns="http://www.w3.org/2000/svg" class="light-icon" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="dark-icon" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><g><rect fill="none" height="24" width="24"/></g><g><g><g><path d="M11.1,12.08C8.77,7.57,10.6,3.6,11.63,2.01C6.27,2.2,1.98,6.59,1.98,12c0,0.14,0.02,0.28,0.02,0.42 C2.62,12.15,3.29,12,4,12c1.66,0,3.18,0.83,4.1,2.15C9.77,14.63,11,16.17,11,18c0,1.52-0.87,2.83-2.12,3.51 c0.98,0.32,2.03,0.5,3.11,0.5c3.5,0,6.58-1.8,8.37-4.52C18,17.72,13.38,16.52,11.1,12.08z"/></g><path d="M7,16l-0.18,0C6.4,14.84,5.3,14,4,14c-1.66,0-3,1.34-3,3s1.34,3,3,3c0.62,0,2.49,0,3,0c1.1,0,2-0.9,2-2 C9,16.9,8.1,16,7,16z"/></g></g></svg>
</div>
            </div>
            <svg xmlns="http://www.w3.org/2000/svg" id="toggle-menu" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>

          </div>
          <input type="text" id="search" placeholder="Search... (beta)" autocomplete="off">
        </div>
      </div>
      <nav class="search hidden"></nav>
      <nav class="content hidden">
        <ul>
          <li class="open"><div class="menu-row"><a href="./twinactions.html">twinactions</a></div></li><li class="open"><div class="menu-row"><a href="./crypto.html">crypto</a></div></li><li class="open active"><div class="menu-row"><a href="./tfgrid.html">tfgrid</a></div></li>
        </ul>
      </nav>
    </header>
    <div class="doc-scrollview" id="main-content">
      <div class="doc-container">
        <div class="doc-content">
          						<section id="readme_tfgrid" class="doc-node">
							<div class="title"><h1> tfgrid <a href="#readme_tfgrid">#</a></h1></div><h1>TFGrid workload deployment</h1>
<blockquote>
<p>inspired by: <a href="https://library.threefold.me/info/manual/#/manual3_iac/grid3_javascript">https://library.threefold.me/info/manual/#/manual3_iac/grid3_javascript</a></p>
</blockquote>
<p>this client allows deployment of all kinds of workloads on TFGrid</p>
<ul>
<li>kubernetes</li>
<li>vm</li>
<li>zdb</li>
<li>networks</li>
<li>qsfs (quantum safe filesystem)</li>
<li>kvs (key value stor)</li>
<li>gateways</li>
<li>...</li>
</ul>
<blockquote>
<p>TODO:</p>
</blockquote>
<h2>Principles</h2>
<p>The metadata we need to remember is stored in the KVS on TFChain (encrypted by the private key of the account).
This metadata is important it has all info in relation to workloads we have deployed, where are they deployed, ...</p>
<h2>TODO</h2>
<ul>
<li>key value stor on tfchain</li>
<li>most of primitives</li>
<li>how to do capacity planning using the TFGrid Proxy</li>
</ul>

</section>

						<section id="vm_info" class="doc-node">
							<div class="title"><h2>fn vm_info <a href="#vm_info">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">vm_info</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">?</span>VMInfo</code></pre>
<p>get object info from a deployed ZDB namespace</p>

</section>
						<section id="account_init" class="doc-node">
							<div class="title"><h2>fn account_init <a href="#account_init">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">account_init</span><span class="token punctuation">(</span>args AccountArgs<span class="token punctuation">)</span></code></pre>
<p>init the account on the action handler for TFGrid will give error if it already exists and mneomonic or type different will also give error if an error to create it e.g. wrong mnemonic the account will be selected, which means all actions done after are done on this account</p>

</section>
						<section id="account_delete" class="doc-node">
							<div class="title"><h2>fn account_delete <a href="#account_delete">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">account_delete</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">?</span></code></pre>
<p>delete account on the handler in case it was already initialized, does not give error if not active yet if multisignature more than one will have to do</p>

</section>
						<section id="zdb_info" class="doc-node">
							<div class="title"><h2>fn zdb_info <a href="#zdb_info">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">zdb_info</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">?</span>ZDBInfo</code></pre>
<p>get object info from a deployed ZDB namespace</p>

</section>
						<section id="zdb_delete" class="doc-node">
							<div class="title"><h2>fn zdb_delete <a href="#zdb_delete">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">zdb_delete</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">?</span></code></pre>


</section>
						<section id="vm_create" class="doc-node">
							<div class="title"><h2>fn vm_create <a href="#vm_create">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">vm_create</span><span class="token punctuation">(</span>args VMArgs<span class="token punctuation">)</span> <span class="token operator">?</span></code></pre>
<p>init the account on the action handler for TFGrid will give error if it already exists and mneomonic or type different will also give error if an error to create it e.g. wrong mnemonic the account will be selected, which means all actions done after are done on this account</p>

</section>
						<section id="vm_delete" class="doc-node">
							<div class="title"><h2>fn vm_delete <a href="#vm_delete">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">vm_delete</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">?</span></code></pre>


</section>
						<section id="zdb_create" class="doc-node">
							<div class="title"><h2>fn zdb_create <a href="#zdb_create">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">zdb_create</span><span class="token punctuation">(</span>args ZDBArgs<span class="token punctuation">)</span> <span class="token operator">?</span></code></pre>
<p>init the account on the action handler for TFGrid will give error if it already exists and mneomonic or type different will also give error if an error to create it e.g. wrong mnemonic the account will be selected, which means all actions done after are done on this account</p>

</section>
						<section id="ZDBMode" class="doc-node">
							<div class="title"><h2>enum ZDBMode <a href="#ZDBMode">#</a></h2></div><pre class="signature"><code><span class="token keyword">enum</span> <span class="token symbol">ZDBMode</span> <span class="token punctuation">{</span>
	user
	seq
<span class="token punctuation">}</span></code></pre>


</section>
						<section id="AccountArgs" class="doc-node">
							<div class="title"><h2>struct AccountArgs <a href="#AccountArgs">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">AccountArgs</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	name       <span class="token builtin">string</span>
	mnemonic   <span class="token builtin">string</span> <span class="token comment">// private key in mnemonic form to be able to work on the right TFGrid net (TFChain)</span>
	nettype    TFGridNet
	expiration <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">300</span> <span class="token comment">// will expire default 5 min</span>
	multisig   MultiSig <span class="token comment">// optional, not implemented yet in TFGrid</span>
<span class="token punctuation">}</span></code></pre>


</section>
						<section id="VMInfo" class="doc-node">
							<div class="title"><h2>struct VMInfo <a href="#VMInfo">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">VMInfo</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	name        <span class="token builtin">string</span>
	disks       <span class="token punctuation">[</span><span class="token punctuation">]</span>VMDisk
	network     VMNet
	node_id     <span class="token builtin">u32</span>  <span class="token comment">// id of the node where this VM needs to be deployed</span>
	public_ip   <span class="token builtin">bool</span> <span class="token comment">// connect virtual machine to public internet, this VM will receive an IP address</span>
	planetary   <span class="token builtin">bool</span> <span class="token comment">// connect the virtual machine to the planetary network</span>
	cpu         <span class="token builtin">u8</span>   <span class="token comment">// nr of cpu cores 1...16</span>
	memory      <span class="token builtin">u16</span>  <span class="token comment">// MB of ram e.g. 1024*2 would be 2 GB</span>
	rootfs_size <span class="token builtin">u16</span>    <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">// GB of root filesystem</span>
	flist       <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'https://hub.grid.tf/tf-official-apps/base:latest.flist'</span>
	entrypoint  <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'/sbin/zinit init'</span>
	env         <span class="token builtin">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token comment">// environment variables as passed to VM</span>
	ssh_key     <span class="token builtin">string</span> <span class="token comment">// default ssh_key is alias to SSH_KEY in env</span>
<span class="token punctuation">}</span></code></pre>
<p>TODO what info comes back?</p>

</section>
						<section id="VMNet" class="doc-node">
							<div class="title"><h2>struct VMNet <a href="#VMNet">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">VMNet</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	name  <span class="token builtin">string</span>
	range IPRange
<span class="token punctuation">}</span></code></pre>
<p>network needs to correspond to network created on nodes, otherwise this will not work</p>

</section>
						<section id="VMArgs" class="doc-node">
							<div class="title"><h2>struct VMArgs <a href="#VMArgs">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">VMArgs</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	name        <span class="token builtin">string</span>
	disks       <span class="token punctuation">[</span><span class="token punctuation">]</span>VMDisk
	network     VMNet
	node_id     <span class="token builtin">u32</span>  <span class="token comment">// id of the node where this VM needs to be deployed</span>
	public_ip   <span class="token builtin">bool</span> <span class="token comment">// connect virtual machine to public internet, this VM will receive an IP address</span>
	planetary   <span class="token builtin">bool</span> <span class="token comment">// connect the virtual machine to the planetary network</span>
	cpu         <span class="token builtin">u8</span>   <span class="token comment">// nr of cpu cores 1...16</span>
	memory      <span class="token builtin">u16</span>  <span class="token comment">// MB of ram e.g. 1024*2 would be 2 GB</span>
	rootfs_size <span class="token builtin">u16</span>    <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">// GB of root filesystem</span>
	flist       <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'https://hub.grid.tf/tf-official-apps/base:latest.flist'</span>
	entrypoint  <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'/sbin/zinit init'</span>
	env         <span class="token builtin">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token comment">// environment variables as passed to VM</span>
	ssh_key     <span class="token builtin">string</span> <span class="token comment">// default ssh_key is alias to SSH_KEY in env</span>
<span class="token punctuation">}</span></code></pre>


</section>
						<section id="MultiSig" class="doc-node">
							<div class="title"><h2>struct MultiSig <a href="#MultiSig">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">MultiSig</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	pubkeys       <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token comment">// the pubkeys of who needs to sign</span>
	min_signature <span class="token builtin">i16</span>      <span class="token comment">// how many need minimally to sign</span>
<span class="token punctuation">}</span></code></pre>
<p>used for when we do smart contract for IT with multiple people</p>

</section>
						<section id="IPRange" class="doc-node">
							<div class="title"><h2>struct IPRange <a href="#IPRange">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">IPRange</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	range <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'10.10.0.0'</span>
	mask  <span class="token builtin">i16</span>    <span class="token operator">=</span> <span class="token number">16</span>
<span class="token punctuation">}</span></code></pre>


</section>
						<section id="ZDBArgs" class="doc-node">
							<div class="title"><h2>struct ZDBArgs <a href="#ZDBArgs">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">ZDBArgs</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	name      <span class="token builtin">string</span>
	node_id   <span class="token builtin">u32</span> <span class="token comment">// id of the node where this ZDB namespace needs to be deployed</span>
	mode      ZDBMode
	disk_size <span class="token builtin">u16</span> <span class="token operator">=</span> <span class="token number">9</span>
	public    <span class="token builtin">bool</span>   <span class="token comment">// a public namespace can be read-only if a password is set</span>
	password  <span class="token builtin">string</span> <span class="token comment">// password as set on the namespace</span>
<span class="token punctuation">}</span></code></pre>


</section>
						<section id="ZDBInfo" class="doc-node">
							<div class="title"><h2>struct ZDBInfo <a href="#ZDBInfo">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">ZDBInfo</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	name      <span class="token builtin">string</span>
	node_id   <span class="token builtin">u32</span> <span class="token comment">// id of the node where this ZDB namespace needs to be deployed</span>
	mode      ZDBMode
	disk_size <span class="token builtin">u16</span> <span class="token operator">=</span> <span class="token number">9</span>
	public    <span class="token builtin">bool</span>   <span class="token comment">// a public namespace can be read-only if a password is set</span>
	password  <span class="token builtin">string</span> <span class="token comment">// password as set on the namespace</span>
<span class="token punctuation">}</span></code></pre>
<p>TODO what info comes back?</p>

</section>
						<section id="VMDisk" class="doc-node">
							<div class="title"><h2>struct VMDisk <a href="#VMDisk">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">VMDisk</span> <span class="token punctuation">{</span>
<span class="token keyword">pub</span><span class="token punctuation">:</span>
	name       <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'default'</span>
	size       <span class="token builtin">i16</span>    <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment">// GB size of disk</span>
	mountpoint <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'/testdisk'</span>
<span class="token punctuation">}</span></code></pre>


</section>

          <div class="footer">
            Powered by vdoc.
          </div>
        </div>
        <div class="doc-toc"><ul><li class="open"><a href="#readme_tfgrid">README</a></li>
<li class="open"><a href="#vm_info">fn vm_info</a>        <ul>
</ul>
</li>
<li class="open"><a href="#account_init">fn account_init</a>        <ul>
</ul>
</li>
<li class="open"><a href="#account_delete">fn account_delete</a>        <ul>
</ul>
</li>
<li class="open"><a href="#zdb_info">fn zdb_info</a>        <ul>
</ul>
</li>
<li class="open"><a href="#zdb_delete">fn zdb_delete</a>        <ul>
</ul>
</li>
<li class="open"><a href="#vm_create">fn vm_create</a>        <ul>
</ul>
</li>
<li class="open"><a href="#vm_delete">fn vm_delete</a>        <ul>
</ul>
</li>
<li class="open"><a href="#zdb_create">fn zdb_create</a>        <ul>
</ul>
</li>
<li class="open"><a href="#ZDBMode">enum ZDBMode</a>        <ul>
</ul>
</li>
<li class="open"><a href="#AccountArgs">struct AccountArgs</a>        <ul>
</ul>
</li>
<li class="open"><a href="#VMInfo">struct VMInfo</a>        <ul>
</ul>
</li>
<li class="open"><a href="#VMNet">struct VMNet</a>        <ul>
</ul>
</li>
<li class="open"><a href="#VMArgs">struct VMArgs</a>        <ul>
</ul>
</li>
<li class="open"><a href="#MultiSig">struct MultiSig</a>        <ul>
</ul>
</li>
<li class="open"><a href="#IPRange">struct IPRange</a>        <ul>
</ul>
</li>
<li class="open"><a href="#ZDBArgs">struct ZDBArgs</a>        <ul>
</ul>
</li>
<li class="open"><a href="#ZDBInfo">struct ZDBInfo</a>        <ul>
</ul>
</li>
<li class="open"><a href="#VMDisk">struct VMDisk</a>        <ul>
</ul>
</li>
</ul></div>
      </div>
    </div>
  </div>
  <script src="doc.js"></script>
  <script async src="search_index.js"></script>
</body>

</html>
